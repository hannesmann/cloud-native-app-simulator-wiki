# Input File

HydraGen uses a standard taxonomy with hierarchical structure, which is the input to the Generator module. The input to this module must be given in JSON format following the taxonomy described here.

## Overall Application Taxonomy

At least one cluster and endpoint is required. Other sections are optional and will be set to their default values if omitted.

```json
{
  "services": [
    {
      "name": "<string>",
      "clusters": [...],
      "resources": {...},
      "processes": <integer>,
      "threads": <integer>,
      "readiness_probe": <integer>,
      "endpoints": [...]
    }
  ],
  ...
}
```

## Describing Workload Placement and Scaling

The user can define the placement of each microservice on a specific node, cluster, or namespace. It is also possible to specify the number of microservice replicas once deployed.

```json
"clusters": [
    {
      "cluster": "<string>",
      "node": "<string>",
      "namespace": "<string>",

      // Optional attributes
      "replicas": <integer>,
      "annotations": [...]
    },
    ...
]
```

## Describing Resource Allocation

HydraGen also supports the configuration of the requested resources to be allocated to a microservice instance and the maximum resource usage in terms of both CPU and memory.

```json
"resources": {
  "limits": {
    "memory": "<string:bytes>",
    "cpu": "<string:cores>"
  },
  "requests": {
    "memory": "<string:bytes>",
    "cpu": "<string:cores>"
  }
}
```

## Describing Topological Architecture

For each microservice, HydraGen supports a set of configuration parameters that define the topological architecture of an application by describing the dependencies between services. To define the microservice fan-in, different parameters can be used which specify the set of endpoints a component serves. For each endpoint, the user can specify parameters such as protocol and a relative fan-out based on a set of calls to subsequent microservice endpoints as well as the execution mode across these calls. Furthermore, for each subsequent microservice endpoint, the user can specify parameters such as the port and protocol. These options enable the user to generate complex multi-tier application architectures with different fan-in and/or fan-out characteristics.

```json
"endpoints": [
  {
    "name": "<string>",
    "protocol": "<string:http|grpc>",

    // Optional attributes
    "execution_mode": "<string:sequential|parallel>",
    "cpu_complexity": {...},
    "network_complexity": {...}
  },
  ...
]
```

## Describing Resource Stressors

HydraGen supports parameters to express the computational complexity or stress a microservice exerts on the different hardware resources. Initially, CPU-bounded or network-bounded tasks are implemented. The complexity of a CPU-bounded task can be described based on the time a busy-wait is executed, while the load on the network I/O can be described by specifying parameters such as the call forwarding mode and the request/response size for each service endpoint call.

### CPU Complexity

```json
"cpu_complexity": {
  "execution_time": <float:seconds>
}
```

### Network Complexity

```json
"network_complexity": {
  "forward_requests": "string:synchronous|asynchronous",
  "response_payload_size": <integer:chars>,

  // Optional, set to call other services and/or endpoints
  "called_services": [
    {
      "service": "<string>",
      "port": "<string>",
      "endpoint": "<string>",
      "protocol": "<string:http|grpc>",
      "traffic_forward_ratio": <integer>,
      "request_payload_size": <integer:chars>
    }
  ]
}
```

# Examples

Examples for simple and complex applications generated with HydraGen can be found [here](https://github.com/EricssonResearch/cloud-native-app-simulator/tree/main/generator/examples). The .json is the taxonomy description give as input to the application generator and the the clusterX folder(s) contain the Kubernetes .yaml files generated by this module.
